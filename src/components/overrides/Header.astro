---
/**
 * Custom Header - Semantic HTML
 */
import type { Props } from '@astrojs/starlight/props';
import Search from '@astrojs/starlight/components/Search.astro';
---

<header>
  <div class="header-inner">
    <a href="/" class="site-title">How To Win Capitalism</a>
    <div class="controls">
      <Search {...Astro.props} />
      <button type="button" class="menu-toggle" aria-label="Menu" aria-expanded="false" aria-controls="main-nav">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <path d="M3 12h18M3 6h18M3 18h18"/>
        </svg>
      </button>
    </div>
  </div>

  <nav id="main-nav" aria-label="Main navigation" hidden>
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/protocol/introduction/">Introduction</a></li>
      <li><a href="/field-notes/latest/">Latest Updates</a></li>
      <li><a href="/reports/">Reports</a></li>
    </ul>
  </nav>
</header>

<style>
  header {
    background: #fff;
    border-bottom: 1px solid #a2a9b1;
    width: 100%;
    position: sticky;
    top: 0;
    z-index: 9999;
  }

  .header-inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    gap: 16px;
    max-width: 1200px;
    margin: 0 auto;
  }

  .site-title {
    font-family: "Linux Libertine", Georgia, serif;
    font-size: 20px;
    color: #202122;
    text-decoration: none;
    line-height: 1.2;
  }

  @media (min-width: 480px) {
    .site-title {
      font-size: 22px;
    }
  }

  .site-title:hover {
    text-decoration: underline;
  }

  .controls {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
  }

  .menu-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    padding: 0;
    background: transparent;
    border: 1px solid #a2a9b1;
    cursor: pointer;
    color: #202122;
  }

  .menu-toggle:hover {
    background: #f8f9fa;
  }

  nav {
    background: #fff;
    border-bottom: 1px solid #a2a9b1;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  }

  nav[hidden] {
    display: none;
  }

  nav ul {
    list-style: none;
    margin: 0;
    padding: 0;
    max-width: 1200px;
    margin: 0 auto;
  }

  nav li a {
    display: block;
    padding: 14px 16px;
    color: #0645ad;
    text-decoration: none;
    border-bottom: 1px solid #eaecf0;
    background: #fff;
    font-size: 16px;
  }

  nav li a:hover {
    background: #f8f9fa;
    text-decoration: underline;
  }

  nav li:last-child a {
    border-bottom: none;
  }
</style>

<script>
  const toggle = document.querySelector('.menu-toggle');
  const nav = document.getElementById('main-nav');

  toggle?.addEventListener('click', () => {
    const isExpanded = toggle.getAttribute('aria-expanded') === 'true';
    toggle.setAttribute('aria-expanded', String(!isExpanded));
    if (isExpanded) {
      nav?.setAttribute('hidden', '');
    } else {
      nav?.removeAttribute('hidden');
    }
  });
</script>
