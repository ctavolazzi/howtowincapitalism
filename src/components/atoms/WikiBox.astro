---
/**
 * WIKIBOX - THE ATOM
 *
 * Design Patterns:
 * - Composite: Base building block
 * - Strategy: Variants for different styles
 * - Template Method: Slots for customization
 *
 * All colors/spacing come from CSS custom properties (single source of truth).
 */

export interface Props {
  variant?: 'default' | 'warning' | 'info' | 'sidebar' | 'nav' | 'cta';
  title?: string;
  class?: string;
  id?: string;
  padding?: 'none' | 'sm' | 'md' | 'lg';
}

const {
  variant = 'default',
  title,
  class: className,
  id,
  padding = 'md'
} = Astro.props;

// Compose classes (clean approach)
const boxClasses = [
  'wiki-box',
  `wiki-box--${variant}`,
  `wiki-box--padding-${padding}`,
  className
].filter(Boolean).join(' ');
---

<div class={boxClasses} id={id}>
  {title && (
    <header class="wiki-box__header">
      <slot name="header-icon" />
      <span class="wiki-box__title">{title}</span>
      <slot name="header-actions" />
    </header>
  )}
  <div class="wiki-box__body">
    <slot />
  </div>
  <slot name="footer" />
</div>

<style>
  /* WikiBox uses design tokens from custom.css - NO hardcoded values */
  .wiki-box {
    display: flex;
    flex-direction: column;
    background: var(--color-bg);
    border: var(--border-width) solid var(--color-border);
    color: var(--color-text);
    margin: var(--space-lg) 0;
    box-sizing: border-box;
  }

  .wiki-box__header {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    background: var(--color-surface);
    padding: var(--space-md);
    border-bottom: var(--border-width) solid var(--color-border);
    font-weight: 600;
  }

  .wiki-box__title { flex: 1; }
  .wiki-box__body { padding: var(--space-md); }

  /* Padding variants */
  .wiki-box--padding-none .wiki-box__body { padding: 0; }
  .wiki-box--padding-sm .wiki-box__body { padding: var(--space-sm); }
  .wiki-box--padding-md .wiki-box__body { padding: var(--space-md); }
  .wiki-box--padding-lg .wiki-box__body { padding: var(--space-lg); }

  /* Style variants - use design tokens */
  .wiki-box--warning {
    background: var(--color-warning-bg);
    border-color: var(--color-warning-border);
    border-left-width: 4px;
  }
  .wiki-box--warning .wiki-box__header {
    background: var(--color-warning-border);
  }

  .wiki-box--info {
    background: var(--color-info-bg);
    border-color: var(--color-info-border);
  }
  .wiki-box--info .wiki-box__header {
    background: var(--color-info-border);
    color: var(--color-bg);
  }

  .wiki-box--sidebar {
    float: right;
    width: 220px;
    margin: 0 0 var(--space-lg) var(--space-lg);
    font-size: var(--text-sm);
  }
  .wiki-box--sidebar .wiki-box__header {
    background: #ccccff;
    text-align: center;
    justify-content: center;
    font-family: var(--font-serif);
  }

  .wiki-box--nav .wiki-box__header {
    background: var(--color-surface-alt);
  }

  .wiki-box--cta {
    background: var(--color-surface);
    border-color: var(--color-text);
    border-width: 2px;
  }
  .wiki-box--cta .wiki-box__header {
    background: var(--color-text);
    color: var(--color-bg);
    justify-content: center;
    font-family: var(--font-serif);
  }

  /* Responsive */
  @media (max-width: 768px) {
    .wiki-box--sidebar {
      float: none;
      width: 100%;
      margin: var(--space-lg) 0;
    }
  }
</style>
