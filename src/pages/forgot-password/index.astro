---
/**
 * Forgot Password Page
 *
 * Public page to request a password reset.
 * Uses Base.astro layout for consistency.
 */
import Base from '../../layouts/Base.astro';
import ForgotPasswordForm from '../../components/auth/ForgotPasswordForm.astro';
---

<Base title="Forgot Password" description="Enter your email to receive a password reset link" hideNav={false}>
  <div class="auth-page">
    <div class="auth-header">
      <h1>Forgot Password</h1>
      <p>Enter your email to receive a password reset link</p>
    </div>

    <ForgotPasswordForm />

    <p class="back-to-login">
      <a href="/login/">‚Üê Back to Log In</a>
    </p>
  </div>
</Base>

<script>
  import { checkAuth } from '../../lib/auth/api-client';

  // If already logged in, redirect away
  async function checkIfAlreadyLoggedIn() {
    try {
      const { authenticated } = await checkAuth();
      if (authenticated) {
        window.location.href = '/';
      }
    } catch (err) {
      // If auth check fails, stay on the page to avoid redirect loops
      console.warn('Auth check failed on forgot-password:', err);
    }
  }

  checkIfAlreadyLoggedIn();
</script>

<style>
  .auth-page {
    max-width: 500px;
    margin: 0 auto;
    padding: 2rem 1rem;
  }

  .auth-header {
    text-align: center;
    margin-bottom: 2rem;
  }

  .auth-header h1 {
    font-size: 2rem;
    margin-bottom: 0.5rem;
    margin-top: 0;
  }

  .auth-header p {
    color: var(--color-text-muted, #72777d);
    margin: 0;
  }

  .back-to-login {
    margin-top: 1.5rem;
    text-align: center;
  }

  .back-to-login a {
    color: var(--color-link, #0645ad);
    text-decoration: none;
  }

  .back-to-login a:hover {
    text-decoration: underline;
  }

  @media (min-width: 640px) {
    .auth-page {
      padding: 3rem 2rem;
    }
  }
</style>
